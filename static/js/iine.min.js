(()=>{const p="https://vhiweeypifbwacashxjz.supabase.co";const b="sb_publishable_EoB7MFJhCmb6PiAk-GPJ4w_PGhQ44Ru";const g="heart";const n="Send your appreciation";const f={heart:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" aria-hidden="true"><path d="M15 8C8.925 8 4 12.925 4 19c0 11 13 21 20 23.326C31 40 44 30 44 19c0-6.075-4.925-11-11-11c-3.72 0-7.01 1.847-9 4.674A10.99 10.99 0 0 0 15 8"/></svg>',thumbs_up:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg>',upvote:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 17l-6-6-6 6"/><path d="M18 11l-6-6-6 6"/></svg>'};const y=t=>` ${t}`;const m=(t,e)=>{if(t.dataset.ariaLabel){return t.dataset.ariaLabel}if(t.dataset.label){return t.dataset.label}return n};const w=(t,e)=>{const n=t.querySelector("svg");if(n){const r=t.closest(".iine-button")?.dataset.icon||g;if(r==="upvote"){n.setAttribute("stroke-width",e?"3":"2")}else{const a=n.querySelectorAll("path, polygon, circle");a.forEach(t=>{t.setAttribute("fill",e?"currentColor":"none")})}}};document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll(".iine-button");if(t.length===0){return}const e=Array.from(t).map(t=>t.dataset.slug||window.location.pathname);const a=[...new Set(e)];const h=new Map;const n=async()=>{if(a.length===0){return}try{const t=await fetch(`${p}/rest/v1/rpc/get_hits`,{method:"POST",headers:{"Content-Type":"application/json",apikey:b,Authorization:`Bearer ${b}`},body:JSON.stringify({page_slugs:a})});if(!t.ok)throw new Error("Failed to fetch counts");const e=await t.json();if(e&&typeof e==="object"&&!e.error){for(const n in e){const r=e[n];h.set(n,typeof r==="number"?r:0)}}}catch(t){console.error("Error fetching iine counts:",t)}};const r=async()=>{await n();t.forEach(e=>{const n=e.dataset.slug||window.location.pathname;const r=`iine-clicked-${n}`;e.textContent="";let a=document.createElement("span");a.className="icon";e.appendChild(a);let o=document.createElement("span");o.className="counter";e.appendChild(o);let i=h.get(n)||0;o.textContent=y(i);const s=e.dataset.icon||g;if(!e.getAttribute("aria-label")){const u=m(e,s);e.setAttribute("aria-label",u);e.setAttribute("title",u)}e.removeAttribute("aria-hidden");const t=!!localStorage.getItem(r);e.setAttribute("aria-pressed",t.toString());const c=`iine-description-${n.replace(/\W/g,"-")}`;let l=document.getElementById(c);if(!l){l=document.createElement("span");l.id=c;l.style.display="none";l.textContent="Already clicked.";document.body.appendChild(l)}if(f[s]){a.innerHTML=f[s]}else{a.textContent=s}if(localStorage.getItem(r)){e.classList.add("clicked");e.setAttribute("aria-disabled","true");e.setAttribute("aria-describedby",c);if(f[s]){w(a,true)}}const d=async t=>{if(localStorage.getItem(r)||e.getAttribute("aria-disabled")==="true"){return}if(t){t.preventDefault()}e.setAttribute("aria-disabled","true");localStorage.setItem(r,"true");i++;e.classList.add("clicked");e.setAttribute("aria-pressed","true");e.setAttribute("aria-describedby",c);o.textContent=y(i);if(f[s]){w(a,true)}fetch(`${p}/rest/v1/rpc/increment_hits`,{method:"POST",headers:{"Content-Type":"application/json",apikey:b,Authorization:`Bearer ${b}`},body:JSON.stringify({page_slug:n})}).catch(t=>{console.error("Failed to increment page hits:",t)})};e.addEventListener("click",d);e.addEventListener("keydown",t=>{if(t.key==="Enter"||t.key===" "){t.preventDefault();d(t)}})})};r()})})();